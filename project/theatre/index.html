<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme" content="hugo-academic">
    <meta name="generator" content="Hugo 0.31" />
    <meta name="author" content="Yifan Qian">
    <meta name="description" content="PhD Researcher of Computational Social Science">
    <link rel="alternate" hreflang="en-us" href="https://haczqyf.github.io/project/theatre/">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
    <link rel="stylesheet" href="/styles.css">
    <link rel="alternate" href="https://haczqyf.github.io/index.xml" type="application/rss+xml" title="Yifan Qian">
    <link rel="feed" href="https://haczqyf.github.io/index.xml" type="application/rss+xml" title="Yifan Qian">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/png" href="/img/icon.png">
    <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">
    <link rel="canonical" href="https://haczqyf.github.io/project/theatre/">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="@https://twitter.com/qian_yifan">
    <meta property="twitter:creator" content="@https://twitter.com/qian_yifan">
    <meta property="og:site_name" content="Yifan Qian">
    <meta property="og:url" content="https://haczqyf.github.io/project/theatre/">
    <meta property="og:title" content="Theatre Network | Yifan Qian">
    <meta property="og:description" content="">
    <meta property="og:locale" content="en-us">
    <meta property="article:published_time" content="2018-01-01T00:00:00&#43;00:00">
    <meta property="article:modified_time" content="2018-01-01T00:00:00&#43;00:00">
    <title>Theatre Network | Yifan Qian</title>
</head>

<body id="top" data-spy="scroll" data-target="#toc" data-offset="71">
    <nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Yifan Qian</a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="nav-item">
                        <a href="/#about">
            
            <span>Home</span>
            
          </a>
                    </li>
                    <li class="nav-item">
                        <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
                    </li>
                    <li class="nav-item">
                        <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
                    </li>
                    <li class="nav-item">
                        <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <article class="article article-project" itemscope itemtype="http://schema.org/Article">
        <div class="article-container">
            <div class="pub-title">
                <h1 itemprop="name">Theatre Network</h1>
                <span class="pub-authors" itemprop="author">&nbsp;</span>
                <span class="pull-right">
        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Theatre%20Network&amp;url=https%3a%2f%2fhaczqyf.github.io%2fproject%2ftheatre%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fhaczqyf.github.io%2fproject%2ftheatre%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhaczqyf.github.io%2fproject%2ftheatre%2f&amp;title=Theatre%20Network"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fhaczqyf.github.io%2fproject%2ftheatre%2f&amp;title=Theatre%20Network"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Theatre%20Network&amp;body=https%3a%2f%2fhaczqyf.github.io%2fproject%2ftheatre%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


      </span>
            </div>
            <div class="article-style" itemprop="articleBody">
                <div id="d3-container"></div>
            </div>
            <div class="article-tags">
                <a class="btn btn-primary btn-outline" href="/tags/collaboration-network">collaboration-network</a>
            </div>
        </div>
    </article>
    <div class="container">
        <nav>
            <ul class="pager">
            </ul>
        </nav>
    </div>
    <footer class="site-footer">
        <div class="container">
            <p class="powered-by">
                &copy; 2017 Yifan Qian &middot; Powered by the
                <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
                <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.
                <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
                </a>
                </span>
            </p>
        </div>
    </footer>
    <div id="modal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Cite</h4>
                </div>
                <div>
                    <pre><code class="modal-body tex"></code></pre>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
                    <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
                    <div id="modal-error"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="/js/hugo-academic.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
    <script>
    hljs.initHighlightingOnLoad();
    </script>
    <script>
    // Parameter declaration, the height and width of our viz.
    var width = 1000,
        height = 1000;

    // Colour scale for node colours.
    var color = d3.scale.category10();

    // We create a force-directed dynamic graph layout.
    // D3 has number of layouts - refer to the documentation.
    var force = d3.layout.force()
        .charge(-20)
        .linkDistance(30)
        .size([width, height]);


    // We select the < div> we created earlier and add an 
    // SVG = Scalable Vector Graphics
    var svg = d3.select("#d3-container").select("svg")
    if (svg.empty()) {
        svg = d3.select("#d3-container").append("svg")
            .attr("width", width)
            .attr("height", height);
    }

    //Set up tooltip
    var tip = d3.tip()
        .attr('class', 'd3-tip')
        .offset([-10, 0])
        .html(function(d) {
            var focal = d.focal == 1 ? "Focal" : "Not Focal"
            return "<b>Theatre id: </b> " + d.id + "<br />" +
                "<b>Theatre name: </b> " + d.theatreName + "<br />" +
                "<b>Focal: </b> " + focal + "<br />" +
                "<b>Degree: </b> " + d.degree + "<br />" +
                "<b>Unweighted degree centrality: </b> " + d.unweightedDegreeCentrality + "<br />" +
                "<b>Unweighted clossness centrality: </b> " + d.unweightedClossnessCentrality + "<br />" +
                "<b>Weighted clossness centrality: </b> " + d.weightedClossnessCentrality + "<br />" +
                "<b>Unweighted betweenness centrality: </b> " + d.unweightedBetweennessCentrality + "<br />" +
                "<b>Weighted betweenness centrality: </b> " + d.weightedBetweennessCentrality + "<br />" +
                "<b>Unweighted eigenvector centrality: </b> " + d.unweightedEigenvectorCentrality + "<br />" +
                "<b>Weighted eigenvector centrality: </b> " + d.weightedEigenvectorCentrality + "<br />" +
                "<b>Unweighted local clustering coefficient: </b> " + d.unweightedLocalClusteringCoefficient + "<br />" +
                "<b>Weighted local clustering coefficient: </b> " + d.weightedLocalClusteringCoefficient + "<br />" +
                "<b>Unweighted effective size: </b> " + d.unweightedEffectiveSize + "<br />" +
                "<b>Weighted effective size: </b> " + d.weightedEffectiveSize + "<br />" +
                "<b>Unweighted K Nearest Neighbors: </b> " + d.unweightedKNearestNeighbors + "<br />" +
                "<b>Weighted K Nearest Neighbors： </b> " + d.weightedKNearestNeighbors + "<br />" +
                "<b>k-core: </b> " + d.k_core;
        })
    svg.call(tip);

    //Set up tooltip for link
    var tip_link = d3.tip()
        .attr('class', 'd3-tip')
        .offset([-10, 0])
        .html(function(d) {
            //console.log(d);
            return "<b>Link source theatre id:</b> " + d.source.id + "<br />" +
                "<b>Link target theatre id:</b> " + d.target.id + "<br />" +
                "<b>Weight:</b> " + d.weight + "<br />" +
                "<b>Num of co-performaces:</b> " + d.numOfPerformaces;
        })
    svg.call(tip_link);


    // We load the JSON network file.
    d3.json("network_coTheatre.json", function(error, graph) {
        var links_temp = [];
        graph.links.forEach(function(e) {
            var sourceNode = graph.nodes.indexOf(graph.nodes.filter(function(n) {
                    return n.id === e.source;
                })[0]),
                targetNode = graph.nodes.indexOf(graph.nodes.filter(function(n) {
                    return n.id === e.target;
                })[0])
            linkWeight = e.weight;
            linkNumOfPerformaces = e.numOfPerformaces;
            links_temp.push({
                source: sourceNode,
                target: targetNode,
                weight: linkWeight,
                numOfPerformaces: linkNumOfPerformaces

            });
        });




        // We load the nodes and links into the force-directed
        // graph and initialise the dynamics.
        force.nodes(graph.nodes)
            .links(links_temp)
            .start();

        // We create a < line> SVG element for each link
        // in the graph.
        var link = svg.selectAll(".link")
            .data(links_temp)
            .enter().append("line")
            .attr("class", "link")
            .on('mouseover', tip_link.show) //Added
            .on('mouseout', tip_link.hide); //Added

        // We create a < circle> SVG element for each node
        // in the graph, and we specify a few attributes.
        var node = svg.selectAll(".node")
            .data(graph.nodes)
            .enter().append("circle")
            .attr("class", "node")
            .attr("r", function(d) {
                return 0.133 * d.degree + 4;
                // if (d.focal == 1){
                //     return 10; //((d.degree + 50) / 5)
                // }else{
                //     return 10;
                // }

            }) // radius
            .style("fill", function(d) {
                // We colour the node depending on the degree.
                return color(d.focal);
            })
            .call(force.drag)
            .on('mouseover', tip.show) //Added
            .on('mouseout', tip.hide) //Added
            .on('dblclick', connectedNodes);



        // The label each node its node number from the networkx graph.
        // node.append("title")
        //     .text(function(d) { return "Node: " + d.id + "\n" + "Degree: " + d.degree; });

        // node.append("svg:circle")

        // The label each node its node number from the networkx graph.
        // node.append("title").text(function(d) { return "Node: " + d.id + "\n" + "Degree: " + d.degree + "\n" + "Katz: " + d.katz;});

        // We bind the positions of the SVG elements
        // to the positions of the dynamic force-directed graph,
        // at each time step.
        force.on("tick", function() {
            link.attr("x1", function(d) { return d.source.x; })
                .attr("y1", function(d) { return d.source.y; })
                .attr("x2", function(d) { return d.target.x; })
                .attr("y2", function(d) { return d.target.y; });

            node.attr("cx", function(d) { return d.x; })
                .attr("cy", function(d) { return d.y; });
        });


        //---Insert-------

        //Toggle stores whether the highlighting is on
        var toggle = 0;

        //Create an array logging what is connected to what
        var linkedByIndex = {};

        graph.nodes.forEach(function(d) {
            linkedByIndex[d.id + "," + d.id] = 1;
        });

        graph.links.forEach(function(d) {
            linkedByIndex[d.source + "," + d.target] = 1;
        });

        //This function looks up whether a pair are neighbours  
        function neighboring(a, b) {
            return linkedByIndex[a + "," + b] || linkedByIndex[b + "," + a];
        }

        function connectedNodes() {

            if (toggle == 0) {



                //Reduce the opacity of all but the neighbouring nodes
                d = d3.select(this).node().__data__;
                // console.log(d)
                node.style("opacity", function(o) {
                    return neighboring(d.id, o.id) ? 1 : 0.1;
                });

                link.style("opacity", function(o) {
                    // console.log(o)
                    return d.id == o.source.id || d.id == o.target.id || (neighboring(d.id, o.source.id) && neighboring(d.id, o.target.id)) ? 1 : 0.1;
                });

                //Reduce the op

                toggle = 1;
            } else {
                //
                //Put them back to opacity=1
                node.style("opacity", 1);
                link.style("opacity", 1);
                toggle = 0;
            }

        }

        //---End Insert---

    });
    </script>
    <style>
    .node {
        stroke: #fff;
        stroke-width: 1.5px;
    }

    .link {
        stroke: #999;
        stroke-opacity: .6;
    }

    .d3-tip {
        line-height: 1;
        color: black;
    }
    </style>
</body>

</html>